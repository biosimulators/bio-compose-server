FROM ghcr.io/biosimulators/bio-compose-server-base:0.0.1

# redundant line to ensure latest worker content; comment out if you don't want this
RUN rm -rf /bio-compose-server/shared \
    && rm -rf /bio-compose-server/worker

COPY ./shared /bio-compose-server/shared
COPY ./worker /bio-compose-server/worker

# CMD ["bash", "-c", "source /.bashrc && python3 worker/main.py"]
COPY ./shared/scripts/entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
CMD ["python3", "worker/main.py"]

